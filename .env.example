# Serma configuration
#
# Usage:
#   cp .env.example .env
#   $EDITOR .env
#   cargo run --release
#
# Precedence:
#   process environment > .env > built-in defaults

# Logging (tracing-subscriber EnvFilter)
RUST_LOG=info

# Storage
SERMA_DATA_DIR=data

# Web
# If SERMA_ADDR is set, Serma binds to it directly.
# If SERMA_ADDR is empty/unset, Serma binds dual loopback on SERMA_WEB_PORT.
SERMA_ADDR=
SERMA_WEB_PORT=3000

# Optional SOCKS5 proxying for DHT UDP traffic
# Examples:
#   SERMA_SOCKS5_PROXY=socks5://127.0.0.1:1080
#   SERMA_SOCKS5_PROXY=socks5://user:pass@host:1080
SERMA_SOCKS5_PROXY=
SERMA_SOCKS5_USERNAME=
SERMA_SOCKS5_PASSWORD=

# Spider (DHT discovery)
SERMA_SPIDER=1
SERMA_SPIDER_BIND=0.0.0.0:0
SERMA_SPIDER_BOOTSTRAP=router.bittorrent.com:6881,dht.transmissionbt.com:6881,router.utorrent.com:6881
SERMA_SPIDER_MAX_KNOWN_NODES=10000
SERMA_SPIDER_SEEN_ROTATE_EVERY_SECS=900
SERMA_SPIDER_SEEN_BITS_POW2=26
SERMA_SPIDER_SEEN_K=12
SERMA_SPIDER_SAMPLE_EVERY_SECS=5
SERMA_SPIDER_SAMPLE_PER_TICK=12
SERMA_SPIDER_MAX_SAMPLES_PER_MSG=256
SERMA_SPIDER_BOOTSTRAP_EVERY_SECS=15
SERMA_SPIDER_GC_EVERY_SECS=30

# Enrich (metadata + indexing)
SERMA_ENRICH_MISSING_SCAN_LIMIT=200
SERMA_ENRICH_MAX_CONCURRENT=64
SERMA_ENRICH_PEERS_PER_HASH=64
SERMA_ENRICH_DHT_BOOTSTRAP=router.bittorrent.com:6881,dht.transmissionbt.com:6881,router.utorrent.com:6881
SERMA_ENRICH_DHT_QUERY_TIMEOUT_MS=900
SERMA_ENRICH_DHT_MAX_QUERIES_PER_HASH=32
SERMA_ENRICH_DHT_GET_PEERS_TIMEOUT_SECS=12
SERMA_ENRICH_DHT_OVERALL_DEADLINE_SECS=10
SERMA_ENRICH_DHT_INFLIGHT=8
SERMA_ENRICH_DHT_RECV_TIMEOUT_MS=250
SERMA_ENRICH_METADATA_INFLIGHT=8
SERMA_ENRICH_METADATA_OVERALL_TIMEOUT_SECS=16

# Cleanup (index hygiene)
SERMA_CLEANUP=1
SERMA_CLEANUP_EVERY_SECS=10
SERMA_CLEANUP_BATCH=5000
SERMA_CLEANUP_MAX_MS=1000
SERMA_TORRENT_TTL_SECS=86400
SERMA_LOW_SEED_GRACE_SECS=1200
SERMA_MAX_TORRENTS=0
